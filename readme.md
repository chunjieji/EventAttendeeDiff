# 活动人员对比工具需求文档

## 1. 项目背景

### 1.1 项目概述
活动人员对比工具是一款专为活动组织者设计的Web应用，旨在解决活动签到统计问题。通过比对预期参加人员名单与实际参加人员名单，快速识别缺席人员，提高活动管理效率。

### 1.2 目标用户
- 企业HR/行政人员
- 学校教师/班主任
- 活动组织者
- 会议/培训管理人员

### 1.3 痛点分析
- 手动核对人员名单费时费力
- 纸质签到表难以快速统计
- 图片形式的名单需要人工转录
- 缺席人员难以及时发现和跟进

## 2. 技术选型

### 2.1 前端技术
- **Next.js**: 用于构建服务端渲染和静态网站生成的React框架
- **React**: 用户界面库
- **Axios**: HTTP客户端，用于API请求
- **Webpack**: 模块打包工具
- **TailwindCSS**: 用于快速UI开发的CSS框架
- **TypeScript**: 增强代码可维护性和开发体验

### 2.2 后端技术
- **Next.js API Routes**: 处理API请求
- **智谱GLM-4V-Flash API**: 图像识别和文本处理
- **mongoDB**: 数据库存储数据

### 2.3 部署环境
- **Vercel**: 用于Next.js应用的部署平台
- **GitHub**: 代码版本控制

## 3. 功能需求

### 3.1 核心功能

#### 3.1.1 名单输入
- **预期参加人员名单输入**
  - 文本输入：支持直接输入用逗号分隔的人名
  - 图片上传：支持含有人名的图片上传，通过AI识别转换为文本
  
- **实际参加人员名单输入**
  - 文本输入：支持直接输入用逗号分隔的人名
  - 图片上传：支持含有人名的图片上传，通过AI识别转换为文本

#### 3.1.2 AI图像识别
- 调用智谱GLM-4V-Flash API进行图像内容识别
- 从图片中提取人名信息并转换为逗号分隔的文本格式
- 支持常见图片格式：JPG、PNG、PDF等
- 支持手写和打印文本的识别

#### 3.1.3 名单比对
- 自动比对预期参加人员与实际参加人员
- 生成缺席人员名单
- 支持模糊匹配，处理同名不同写法的情况（如"张三"和"张 三"）
- 提供比对结果的可视化展示

#### 3.1.4 结果展示与导出
- 显示预期参加人数和实际参加人数的统计信息
- 展示缺席人员名单

### 3.2 扩展功能

#### 3.2.1 名单管理
- 支持创建和保存常用名单模板，模板数据通过后端接口保存到MongoDB数据库
- 在输入预期参加人员名单时可以选择模板
- 提供名单模板的CRUD操作（创建、读取、更新、删除）
- 支持名单模板分类管理（如按部门、班级、项目组等）
- 支持名单导入导出功能（Excel格式）
- 提供名单搜索和筛选功能

#### 3.2.2 用户认证与权限管理
- 用户注册与登录系统
- 基于角色的权限控制（管理员、普通用户）
- 个人数据隐私保护

#### 3.2.3 数据分析与报告
- 活动出勤率统计与可视化
- 历史记录查询与比对
- 缺勤趋势分析
- 自定义报表生成与导出（Excel）
- 数据看板展示关键指标

## 4. 用户界面设计

### 4.1 页面结构
- **主功能页**：包含名单输入、比对和结果展示

### 4.2 主功能页布局

#### 4.2.1 名单输入区域
- 左侧：预期参加人员名单输入
  - 文本输入框
  - 图片上传按钮
  
- 右侧：实际参加人员名单输入
  - 文本输入框
  - 图片上传按钮

#### 4.2.2 操作按钮区域
- 比对按钮
- 清空按钮

#### 4.2.3 结果展示区域
- 统计信息：预期人数、实际人数、缺席人数
- 缺席人员名单（可复制）

### 4.3 交互设计
- 实时反馈：名单输入后实时显示人数
- 加载状态：AI处理图片时显示进度指示器
- 响应式设计：适配桌面和移动设备

### 4.4 扩展功能页面设计

#### 4.4.1 名单管理页面
- **布局结构**
  - 顶部：搜索栏和筛选选项
  - 左侧：名单模板分类导航
  - 中央：名单模板列表（卡片式展示）
  - 右侧：模板详情和操作区

- **功能组件**
  - 模板创建按钮：打开创建模板弹窗
  - 模板编辑界面：支持批量添加、导入导出
  - 模板应用按钮：将选中模板应用到主功能页

#### 4.4.2 用户中心页面
- **布局结构**
  - 顶部：用户信息展示
  - 侧边栏：功能导航菜单
  - 主区域：内容展示区

- **功能组件**
  - 登录/注册表单
  - 个人资料设置
  - 权限管理界面（管理员专用）
  - 账号绑定选项

#### 4.4.3 数据分析页面
- **布局结构**
  - 顶部：时间范围选择器和筛选条件
  - 中央：数据可视化图表区
  - 底部：详细数据表格

- **功能组件**
  - 多样化图表：柱状图、折线图、饼图等
  - 数据导出按钮
  - 自定义报表生成器
  - 数据看板配置选项

## 5. 技术实现细节

### 5.1 前端架构
- 采用Next.js的Pages Router或App Router架构
- 使用React Hooks管理状态
- 实现组件化设计，提高代码复用性

### 5.2 API集成

#### 5.2.1 智谱GLM-4V-Flash API集成
- API请求地址：https://open.bigmodel.cn/api/paas/v4/
- APIKEY：75b627b72dd94af6ae7304f72c810263.ErWsFP01mMFjIMr0
- 参考文档：https://docs.bigmodel.cn/cn/guide/develop/http/introduction#javascript

#### 5.2.2 API请求流程
1. 前端上传图片到Next.js API Route
2. API Route将图片转发给智谱API
3. 接收并处理智谱API返回的结果
4. 将处理后的文本返回给前端

### 5.3 数据处理
- 名单格式化：统一处理各种输入格式
- 名单比对算法：实现高效的名单比对
- 错误处理：处理API调用失败、图片识别错误等异常情况

## 6. 安全与隐私

### 6.1 数据安全
- 不永久存储用户上传的图片和名单数据
- 使用HTTPS确保数据传输安全
- 实现API密钥的安全管理

### 6.2 隐私保护
- 明确的隐私政策
- 用户数据使用说明
- 符合相关数据保护法规

## 附录

### A. API调用示例

```javascript
// 智谱GLM-4V-Flash API调用示例
async function recognizeImage(imageBase64) {
  const response = await axios.post(
    'https://open.bigmodel.cn/api/paas/v4/chat/completions',
    {
      model: 'glm-4v-flash',
      messages: [
        {
          role: 'user',
          content: [
            { type: 'text', text: '请识别图片中的所有人名，用逗号分隔输出' },
            { type: 'image_url', image_url: { url: `data:image/jpeg;base64,${imageBase64}` } }
          ]
        }
      ]
    },
    {
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer 75b627b72dd94af6ae7304f72c810263.ErWsFP01mMFjIMr0'
      }
    }
  );
  
  return response.data;
}
```
